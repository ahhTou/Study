<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
</body>
<canvas id="myCanvas">不支持Canvas</canvas>
<style>
    * {
        margin: 0;
        padding: 0;
        border: 0;
    }

    body {
        height: 100vh;
        width: 100vw;
    }
</style>
<script>
    const canvas = document.getElementById('myCanvas')
    const ctx = canvas.getContext('2d')
    canvas.width = document.body.clientWidth
    canvas.height = document.body.clientHeight

    const colorArr = [
        '#FFFFCC',
        '#CCFFFF',
        '#FFCCCC',
        '#CCCCFF',
        '#FFCC99'
    ]

    const mouse = {
        x: canvas.width / 2,
        y: canvas.height / 2
    }

    window.addEventListener('mousemove', event => {
        mouse.x = event.clientX
        mouse.y = event.clientY
    })

    window.addEventListener('resize', () => {
        canvas.width = document.body.clientWidth
        canvas.height = document.body.clientHeight
    })

    class Ball {
        constructor(x, y, sX, sY, radius, color) {
            this.x = x
            this.y = y
            this.dx = sX
            this.dy = sY
            this.radius = radius
            this._radius = radius
            this.color = color
        }

        draw() {
            ctx.beginPath() // 重新起一个路径
            ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI, false)
            ctx.fillStyle = this.color
            ctx.fill()
            ctx.closePath()
        }

        move() {
            if (this.x + this.radius > canvas.width || this.x - this.radius < 0) {
                this.dx = -this.dx
            }
            if (this.y + this.radius > canvas.height || this.y - this.radius < 0) {
                this.dy = -this.dy
            }

            if (this.x + this.radius > canvas.width + 10) {
                this.x = canvas.width - this.radius * 2
                this.dy = -this.dy
            }
            if (this.y + this.radius > canvas.height + 10) {
                this.y = canvas.height - this.radius * 2
                this.dy = -this.dy

            }


            this.x += this.dx
            this.y += this.dy

            // 鼠标交互
            if (mouse.x - this.x < 50
                && mouse.x - this.x > -50
                && mouse.y - this.y < 50
                && mouse.y - this.y > -50
            ) {
                if (this.radius < this._radius * 5) this.radius += 1
            } else {
                if (this.radius > this._radius) {
                    this.radius -= 0.1
                }
            }

            this.draw()
        }
    }

    const ballArr = []
    for (let i = 0; i < 1000; i++) {
        let radius = Math.random() * 8 + 1
        let x = Math.random() * (canvas.width - 2 * radius)
        let y = Math.random() * (canvas.height - 2 * radius)
        let sx = (Math.random() - 0.5) * 2
        let sy = (Math.random() - 0.5) * 2
        let color = colorArr[Math.floor(Math.random() * 5)]
        ballArr.push(new Ball(x, y, sx, sy, radius, color))
    }


    // 动画，浏览器调用刷新动画
    function animate() {
        requestAnimationFrame(animate)
        ctx.clearRect(0, 0, canvas.width, canvas.height)
        for (const ball of ballArr) {
            ball.move()
        }
    }

    animate()
</script>

</html>
